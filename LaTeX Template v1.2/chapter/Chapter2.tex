\chapter{技术综述}

本文设计和实现的文件自动发送平台使用SpringBoot为主体框架进行开发，
根据功能不同将平台分为多个模块进行开发，每一个模块单独放在一个包中，公共组件类放入公共包中。
底层数据库使用金融系统常见的Oracle数据库。
采用Spring Cloud中的Eureka提供对外接口，Feign对邮件、传真、短信服务进行调用。
前端使用Vue进行开发，UI使用ElementUI框架。
采用Tesseract进行OCR识别PDF文字。

\section{模块化介绍}
模块化设计的历史非常悠久，覆盖范围广泛。
不仅广泛应用于UI设计、软件开发之中，在报纸版面、室内设计、机械制造、土木工程中也无处不在。
软件设计中的模块化设计是指将系统整体根据一定的原则划分为多个小块，称之为模块。
模块之间通过定义良好的接口进行交互，合理有序的组织整个系统。
每个模块独立进行设计开发，可以并行的推进系统的开发进度，更合理的分配人员，提升工作效率。
模块可以提高软件的复用性，职责明确，功能单一的模块可以方便的供给开发人员调用，不需要开发人员对相同的功能进行多个设计，保证了设计的一致性，降低了成本，提升效率。
依照原则划分的模块通常都符合高内聚，低耦合的原则。模块间相对独立，便于升级和维护，移植性高。

\section{SMTP协议}
简单邮件传输协议SMTP是一个在互联网上传输电子邮件的标准。
该标准在1981年首次发布，起初只是作为UUCP的补充，UUCP更适合于处理在间歇连接的机器间传送邮件。相反，SMTP在发送和接收的机器在持续连线的网络情况下工作得最好。
然后经过不断完善以适应技术和用户需求的变化，从最初正文仅支持无重音拉丁字符，到后来的MIME中的HTML组件和非文本附件，从开放邮件转发（无限制，无需身份验证）到SMTP身份验证，从纯文本通信到STARTTLS加密信息，SMTP已被普遍选作将电子邮件从一个电子邮件服务器传输到另一个电子邮件服务器的协议。

SMTP是一个相对简单的基于文本的协议。发件人向SMTP接受服务器发出命令，在其之上指定了一条消息的一个或多个接收者，然后消息文本会被传输到发送方的邮件服务器，发送方的邮件服务器解析指定的一个或多个接收者的邮件服务器地址，使用STMP协议将邮件发送到接收方的邮件服务器，最终收件人使用POP3/IMAP协议从接收方的邮件
服务器下载邮件到本地并删除服务器上的邮件。流程图如图~\ref{email1}所示。
\begin{figure}[htb]
  \centering
  \includegraphics[width=\linewidth]{codepic/email1.jpg}
  \caption{邮件发送流程}\label{email1}
\end{figure}

JavaMail 是Java 实现了邮件发送和接收功能的一套标准开发类库，支持常用的邮件协议。使用简单方便，本项目使用他来进行邮件传输。


\section{Spring 技术介绍}
Spring 框架是一个基于Java平台，为开发Java应用程序提供全面的基础架构支持。
2002年Rod Johnson 根据多年经验撰写的\emph{Expert One-on-One J2EE Design and Development}，
指出了EJB 开发方式的弊端，作者详尽地描述了在不使用EJB的情况下构建高质量的应用程序。
不久，两位开发者说服Rod Johnson 基于这本书上的代码创建了一个开源基础框架项目，新框架使用了Spring 这个名字。
一经推出就受到了热烈的欢迎，在不断的发展中Spring 丰富了组件，成为Java 进行Web 开发的首选。

\subsection{IOC/AOP}
控制反转（IOC）是spring的核心部分，有时也被称为依赖注入。
IOC是一种有别于传统面向对象编程（OOP）中组织对象的思想，传统的调用对象方法的步骤是在需要时创建目标对象，然后通过对象进行方法的调用。
这种方式简单直接，但是随着Java越来越广泛地应用于互联网应用开发，这些网络应用中包含了大量的对象。对象之间相互合作，相互依赖。由开发人员来进行对象的创建就显得繁琐，难于管理。
并且Java缺乏将松散对象组合为整体的有效方法，
虽然可以通过诸如工厂模式、抽象工程模式、建造者模式、组合模式等设计模式来组织应用的类和实例，
但是设计模式只是给出了模式的定义，应用场景，和如何设计，实际开发中仍然需要开发人员自己实现他们。
而IOC将对象的创建和依赖管理交给了IOC容器，IOC容器创建对象并且在程序需要的地方注入对象，达到程序的解耦、简化开发的效果。

面向切面编程（AOP）是对OOP的延续。OOP通过封装、继承和多态来对实体进行属性和行为进行封装，使得业务逻辑单元更加清晰。行为上将有公共行为的一组实体抽象为类，实体间通过属性来进行区分。结构上通过继承来实现一个从上到下的树状结构，子类继承了父类的一定属性和行为，属于同一类对象。这使得在同一类对象中加入公共行为非常方便，但当我们需要为分散的对象引入公共行为的时候，OOP 则显得无能为力，在不同的类中添加同样的行为是低效且难以维护的。也就是说，OOP 适合定义从上到下的关系，而非从左到右的关系。

如图 ~\ref{oop1}在ClassA类中引入的公共方法，他的子类都可以使用，但是如果想要不同类ClassB也有相同的行为，就有必要在ClassB中定义同样的动作。这中OOP的树状结构适合从上到下的关系，在定义左右关系时遇到了问题。
\begin{figure}[htb]
  \centering
  \includegraphics[width=\linewidth]{codepic/oop1.jpg}
  \caption{面向对象编程的对象结构}\label{oop1}
\end{figure}

AOP可以将公共行为加入到指定的位置，这样公共行为只需要开发一次，插入到多个地方，代码可维护性高。示例如图 ~\ref{aop1}。
典型的有系统中的日志功能，
日志代码往往水平地散布在所有对象层次中，而与它所散布到的对象的核心功能毫无关系。
OOP中将日志功能插入到每个需要的类中是不合适的，而AOP允许将日志功能动态地插入到每一个需要的方法调用的生命周期中。
与日志功能类似的功能还有权限控制、加解密、事务控制等，都可以将公共行为封装为一个切面然后注入到业务逻辑中去。
\begin{figure}[htb]
  \centering
  \includegraphics[width=\linewidth]{codepic/aop1.jpg}
  \caption{面向切面编程的对象结构}\label{aop1}
\end{figure}


\subsection{Spring Boot技术介绍}
由于 Web 应用通常使用MVC分层思想，开发过程中涉及多个框架，经典的有数据层的 Hibrenate 和 mybatis，控制层的 SpringMVC，还有负责提供 IOC 和 AOP 支持的 Spring 框架，另外还可能有用户自己引入的特定的软件。这使得应用配置多，容易出错，框架使用复杂，不利于快速开发。

随着微服务的概念逐渐兴起，2012年Mike Youngstrom提出了在Spring框架中支持无容器的Web应用程序体系结构，促成了Spring Boot的开发。2014年1.0.0版本发布。Spring Boot简化了Spring应用的搭建和开发过程，采用约定大于配置的思想。框架使用了很多默认配置，无需开发人员再定义模板化的配置。并且集成了开发中常见的Jar 包，自动进行管理依赖，无需开发人员进行Jar包管理。集成了内部HTTP容器。显著地提高了开发效率，在微服务的开发中扮演着重要角色。

\subsection{Spring Cloud技术介绍}
随着大数据时代的来临，计算机要处理的数据与日俱增，单台机器难以进行处理，分布式开发成为应对大数据的有利武器。分布式开发在多台机器上创建服务，但可以以一个统一的整体展现给用户。分布式系统屏蔽了多台机器之间通信，协调的复杂性，让用户能够轻松的拥有高性能的机器。

但分布式开发面临着不同于单机的开发的挑战，2000年加州大学伯克利分校的Eric Brewer教授在ACM PODC会议上提出CAP猜想：一个分布式系统最多只能同时满足一致性（Consistency）、可用性（Availability）和分区容错性（Partition tolerance）这三项中的两项。用户独立开发分布式系统开发难度大，需要考虑大量的非业务逻辑的需求。

Spring Cloud是Spring Boot对现有的分布式成熟框架进行了抽象和封装，用于快速构建分布式系统的工具集。提供了分布式系统中常见的模式，例如配置管理、服务发现、断路器、智能路由、微代理、控制总线、一次性令牌、全局锁、领导层选举、分布式会话、群集状态。

\subsubsection{Eureka 技术介绍}
微服务架构中一般会存在一个注册中心，每个微服务启动后会向注册中心注册自己的地址和端口，同时会获取注册中心的服务列表，调用其他服务时就可以从自己获取的服务列表中找到服务地址及端口进行调用。
好处是可以集中管理各个服务，
Eureka是Spring Cloud对Netflix Eureka做了二次封装。

Eureka主要有三个角色组成：Eureka Server、Service Provider、Service Consumer。Eureka Server提供服务注册和发现，以集群方式部署来保证高可用，部分节点故障时整个集群仍可以提供服务，每个节点之间相互同步信息达到一致性。Eureka的设计原则是AP，牺牲一定的一致性，这样即使多数节点故障集群仍然正常工作，节点数据只需要达成最终一致性即可。Service Provider 是服务提供方，将自身服务注册到Eureka，使服务消费方能够找到，比如说使用微服务开发的邮件发送服务。Service Consumer是服务消费方，从Eureka获取注册服务列表，获取服务的地址和端口信息，通过远程过程调用（RPC）服务。详细架构如图~\ref{eureka1}。
\begin{figure}[htb]
  \centering
  \includegraphics[width=\linewidth]{codepic/eureka1.jpg}
  \caption{Eureka架构图}\label{eureka1}
\end{figure}


\subsubsection{Feign技术介绍}
图~\ref{eureka1}中介绍了Service Consumer从Eureka获取服务提供方的接口信息，然后需要进行RPC调用以获取真正的服务。

RPC基于对本地方法调用的扩展，通过扩展这种机制在网络上传输控制和数据。当调用远程过程时，调用环境被挂起，参数通过网络传递到要执行过程的环境（我们将称之为被调用方），所需的过程在那里执行。当过程完成并生成其结果时，结果将被返回到调用环境，在该环境中执行将恢复，就像从简单的单机调用返回一样~\cite{DBLP:journals/tocs/BirrelN84}。

PRC框架封装了过程调用中的参数封装、结果解析、通信等等的细节，Feign是Netflix提供的基于HTTP的RPC调用框架，在Spring Cloud得到广泛应用。
本项目中通过Eureka来实现对外接口；Feign对邮件，传真及短信的微服务调用。

\section{Oracle DataBase技术介绍}
Oracle DataBase是一款处于领先地位的关系型数据库管理系统。虽然越来越多的互联网企业开始使用自研或者开源的数据库，但是Oracle在政府机构，银行机构，企事业单位仍然有广泛使用。
Oracle DB系统可移植性好、使用方便、功能强，适用于各类大、中、小、微机环境，是一种高效率、可靠性好的、适应高吞吐量的数据库方案。

Oracle DB由数据库和实例两大部分组成。数据库是磁盘文件的集合，包括数据文件、控制文件和日志文件。实例是内存中的共享内存池和多个后台进程组成。数据库的磁盘文件不能被用户直接读取，必须通过实例才能访问。一个实例只能连接一个数据库，但是一个数据库可以被多个实例连接。架构如图~\ref{oracle1}所示。
\begin{figure}[htb]
  \centering
  \includegraphics[width=\linewidth]{codepic/oracle1.jpg}
  \caption{Oracle DB实例和数据库关系图}\label{oracle1}
\end{figure}

本项目采用Oracle DB作为数据的存储介质。

\section{Vue框架介绍}
Vue是一套用于构建用户界面的渐进式框架。与其它大型框架不同的是，Vue被设计为可以自底向上逐层应用。Vue 的核心库只关注视图层，不仅易于上手，还便于与第三方库或既有项目整合。另一方面，当与现代化的工具链以及各种支持类库结合使用时，Vue也完全能够为复杂的单页应用提供驱动\cite{vue}。

Vue具由友好、多用途、高性能的特点，可以方便的构建出可维护性、可测试性强的前端代码。Vue是渐进式框架，提供了很多选择的同时但没有主张很多require，允许开发者在一个大型的前端项目中局部简单的引入需要的Vue 组件或功能，而不是引入一个重量级的全家桶。Vue还是响应式的，意味着当数据有变更时，Vue会帮助更新网页中所有用到这个数据的地方。

\subsection{ElementUI 技术介绍}
ElementUI是一套基于 Vue2.0 的桌面端组件库。
它具由一致性、反馈、效率和可控的设计原则。

一致性。与现实生活一致和界面一致。与现实生活的流程、逻辑保持一致，遵循用户习惯的语言和概念；所有的元素和结构需保持一致，比如样式、图标和位置等。

反馈。通过界面样式和交互动效让用户可以清晰的感知自己的操作；操作后，通过页面元素的变化清晰地展现当前状态。

效率。简化流程，设计简洁直观的操作流程；清晰明确，语言表达清晰且表意明确，让用户快速理解进而作出决策；帮助用户识别，界面简单直白，让用户快速识别而非回忆，减少用户记忆负担。

可控。用户决策，根据场景可给予用户操作建议或安全提示，但不能代替用户进行决策；结果可控，用户可以自由的进行操作，包括撤销、回退和终止当前操作等~\cite{elementui}。

本项目使用 Vue.js 和 ElementUI 框架构建清晰、简单、交互良好的前端页面。

\section{OCR 技术介绍}
光学字符识别（OCR）是将打字，手写或印刷文本的图像电子或机械转换为机器编码的文本 ~\cite{ocr}。
OCR 拥有广泛的应用包括但不限于处理名片、车牌、银行账单、发票、邮件、扫描文档、文档照片、场景照片上的文字或者叠加在图像上的字母文字，以便对其进行编辑、搜索、紧凑存储。是模式识别、人工智能、计算机视觉研究的重要一部分。

OCR 的处理流程一般分为影像前处理，文字特征提取，数据库对比。

\subsection{影像前处理}
\subsection{文字特征提取}
\subsection{数据库对比}

\subsection{Tesseract 技术介绍}
Tesseract 是一个支持多多个操作系统的 OCR 引擎。最初由惠普实验室进行开发。项目之后一致未有较大进展，在2005年开源，由 Google 赞助开发。

Tesseract 是目前公认最优秀、最精确的开源 OCR 系统，除了极高的精确度，Tesseract 也具有很高的灵活性。它可以通过训练识别出任何字体，也可以识别出任何 Unicode 字符。


